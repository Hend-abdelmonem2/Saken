<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
  <meta charset="UTF-8">
  <title>تسجيل الدخول</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@400;500;600;700&display=swap" rel="stylesheet" />
  <link rel="shortcut icon" href="favicon.png" />
  <link rel="stylesheet" href="fonts/icomoon/style.css" />
  <link rel="stylesheet" href="fonts/flaticon/font/flaticon.css" />

  <link rel="stylesheet" href="css/tiny-slider.css" />
  <link rel="stylesheet" href="css/aos.css" />
  <link rel="stylesheet" href="css/style.css" />
  <link rel="shortcut icon" href="favicon.png" />

  <style>
    .login-section {
      padding: 60px 0;
      background-color: #f9f9f9;
    }

    .login-box {
      background: #fff;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      max-width: 500px;
      margin: auto;
    }

    .login-box h3 {
      margin-bottom: 25px;
      text-align: center;
    }

    .error {
      color: red;
      text-align: center;
      margin-top: 10px;
    }

    .success {
      color: green;
      text-align: center;
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <!-- Navbar (إن وُجد في القالب) -->
  <!-- include navbar.html if applicable -->




  <div class="hero page-inner overlay" style="background-image: url('images/hero_bg_3.jpg')">
    <div class="container">
      <div class="row justify-content-center align-items-center">
        <div class="col-lg-9 text-center mt-5">
          <h1 class="heading" data-aos="fade-up">Easiest way to find your dream home</h1>

          <nav aria-label="breadcrumb" data-aos="fade-up" data-aos-delay="200">
            <ol class="breadcrumb text-center justify-content-center">
              <li class="breadcrumb-item"><a href="Login.html">Login</a></li>
              <li class="breadcrumb-item active text-white-50" aria-current="page">
                /Login
              </li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>

  <section class="login-section">
    <div class="container">
      <div class="login-box">
        <h3>تسجيل الدخول</h3>
        <form id="loginForm">
          <div class="mb-3">
            <label for="email" class="form-label">البريد الإلكتروني</label><br>
            <input type="email" class="form-control" id="email" placeholder="example@email.com" required>
          </div>

          <div class="mb-3 position-relative">
            <label for="password" class="form-label">كلمة المرور</label>
            <div class="input-group">
              <input type="password" class="form-control" id="password" placeholder="*******" required>
              <button type="button" class="btn btn-outline-secondary" id="togglePassword" tabindex="-1">
                <i class="bi bi-eye-slash" id="toggleIcon"></i>
              </button>
            </div>
          </div>

          <div class="mb-3">
            <label for="role" class="form-label">الدور</label><br>
            <select class="form-select" id="role" required>
              <option value="User">User</option>
              <option value="Tenant">Tenant</option>
              <option value="Owner">owner</option>
            </select>
          </div>

          <button type="submit" class="btn btn-primary w-100">تسجيل الدخول</button>
        </form>

        <div id="message" class="mt-3"></div>
      </div>
    </div>
  </section>

  <!-- Footer (إن وُجد في القالب) -->

  <script>
    const togglePassword = document.getElementById("togglePassword");
    const passwordInput = document.getElementById("password");
    const toggleIcon = document.getElementById("toggleIcon");

    togglePassword.addEventListener("click", () => {
      const type = passwordInput.getAttribute("type") === "password" ? "text" : "password";
      passwordInput.setAttribute("type", type);
      toggleIcon.classList.toggle("bi-eye");
      toggleIcon.classList.toggle("bi-eye-slash");
    });
    const loginForm = document.getElementById("loginForm");
    const messageDiv = document.getElementById("message");

    loginForm.addEventListener("submit", async function (e) {
      e.preventDefault();

      const loginData = {
        email: document.getElementById("email").value,
        password: document.getElementById("password").value,
        role: document.getElementById("role").value
      };

      try {
        const response = await fetch("https://localhost:44327/api/Auth/Login", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(loginData)
        });

        const result = await response.json();

        if (!response.ok) {
          messageDiv.innerHTML = `<div class="error">${result.message || "حدث خطأ أثناء تسجيل الدخول"}</div>`;
        } else {
          messageDiv.innerHTML = `<div class="success">تم تسجيل الدخول بنجاح!</div>`;
          localStorage.setItem("token", result.token);
          localStorage.setItem("refreshToken", result.refreshToken);
          // توجيه
          // window.location.href = "/home.html";
         window.location.href = "AllHouse.html";
        }

      } catch (error) {
        messageDiv.innerHTML = `<div class="error">فشل الاتصال بالخادم!</div>`;
        console.error(error);
      }
    });
  </script>

  <script src="js/bootstrap.bundle.min.js"></script>
  <script src="js/tiny-slider.js"></script>
  <script src="js/aos.js"></script>
  <script src="js/navbar.js"></script>
  <script src="js/counter.js"></script>
  <script src="js/custom.js"></script>

</body>

</html>